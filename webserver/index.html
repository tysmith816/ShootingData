<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <label for="date-input">Select a date:</label>
    <input type="date" id="date-input" value="2024-04-03" min="2015-01-01" max="2024-12-31" />

    <h1 id="date-header">Data for the date 2024-04-03T00:00:00Z:</h1>
    <table></table>    
</body>
<script>
    const body = document.body
    const tbl = document.querySelector('table')
    const url = 'http://localhost:3001/info/'
    let settings = {method: 'GET'}

    const updateTable = (selectedDate) => {
        tbl.innerHTML = ""

        const tr = tbl.insertRow();

        td = tr.insertCell()
        td.appendChild(document.createTextNode(`Location`))
        td.style.border = '1px solid black'

        td = tr.insertCell()
        td.appendChild(document.createTextNode(`Age`))
        td.style.border = '1px solid black'

        td = tr.insertCell()
        td.appendChild(document.createTextNode(`Gender`))
        td.style.border = '1px solid black'

        td = tr.insertCell()
        td.appendChild(document.createTextNode(`Fatal`))
        td.style.border = '1px solid black'

        tbl.style.width = '100px';
        tbl.style.border = '1px solid black';

        document.querySelector('#date-header').innerHTML = "Data for the date " + selectedDate + "T00:00:00Z:"

        fetch(url + selectedDate + 'T00:00:00Z', settings)
            .then(res => res.json())
            .then((json) => {
                //console.log(json)
                json.forEach(entry => {
                    const tr = tbl.insertRow();
        
                    td = tr.insertCell()
                    td.appendChild(document.createTextNode(`${entry.location}`))
                    td.style.border = '1px solid black'

                    td = tr.insertCell()
                    td.appendChild(document.createTextNode(`${entry.age}`))
                    td.style.border = '1px solid black'

                    td = tr.insertCell()
                    td.appendChild(document.createTextNode(`${entry.sex}`))
                    td.style.border = '1px solid black'

                    td = tr.insertCell()
                    if (entry.fatal == 1)
                    {
                        td.appendChild(document.createTextNode(`Yes`))
                    }
                    else
                    {
                        td.appendChild(document.createTextNode(`No`))
                    }
                    td.style.border = '1px solid black'
                })
            })
    }

    updateTable("2024-04-03")
    
    document.getElementById("date-input").addEventListener("change", function() {
        var input = this.value
        updateTable(input)
    })
</script>
</html>